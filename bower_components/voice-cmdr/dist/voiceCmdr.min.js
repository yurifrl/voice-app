var voiceCmdr=function(){var n=this;return this.recognition=window.webkitSpeechRecognition&&new webkitSpeechRecognition,this.isSupported=function(){return!!n.recognition},this.isSupported()&&(this.addCommand=function(i,o){n.DEBUG&&console.debug("added command:",i),n.commands[i]=o},this.removeCommand=function(i){return n.DEBUG&&console.debug("removed command:",i),n.commands[i]?(delete n.commands[i],!0):!1},this.start=function(){n.recognition.continuous=!0,n.recognition.start(),n.DEBUG&&console.debug("started listening")},this.stop=function(){n.recognition.continuous=!1,n.recognition.stop(),n.DEBUG&&console.debug("stopped listening")},this.getCommand=function(){n.recognition.continuous=!1,n.recognition.start(),n.DEBUG&&console.debug("listening for single command")},this.debug=function(i){n.DEBUG=!!i},this.finalTranscript="",this.commands={},this.DEBUG=!1,this.recognizing=!1,this.isRecognizing=function(){return n.recognizing},this.recognition.onstart=function(){n.recognizing=!0},this.recognition.onresult=function(i){if("undefined"==typeof i.results)return n.DEBUG&&console.debug("undefined result"),void n.recognition.stop();for(var o=i.resultIndex;o<i.results.length;++o)i.results[o].isFinal&&(n.finalTranscript+=i.results[o][0].transcript);if(""!==n.finalTranscript){n.finalTranscript=n.finalTranscript.toLowerCase().trim(),n.DEBUG&&console.debug("received command:",n.finalTranscript);for(var e in n.commands)if(0===n.finalTranscript.indexOf(e))if(void 0===n.finalTranscript[e.length])n.DEBUG&&console.debug("calling command",e),n.commands[e]();else if(" "===n.finalTranscript[e.length]){var t=n.finalTranscript.substring(e.length,n.finalTranscript.length).trim();n.DEBUG&&console.debug("calling command",e,"with param:",t),n.commands[e](t)}n.finalTranscript=""}else n.DEBUG&&console.debug("received empty command")},this.recognition.onerror=function(i){n.DEBUG&&console.debug("error occured",i)},this.recognition.onend=function(i){n.recognizing=!1,n.DEBUG&&console.debug("end",i),n.recognition.continuous&&(n.DEBUG&&console.debug("restarting",n.recognition.continuous),n.recognition.start())}),{isSupported:n.isSupported,addCommand:n.addCommand,removeCommand:n.removeCommand,start:n.start,stop:n.stop,getCommand:n.getCommand,debug:n.debug,isRecognizing:n.isRecognizing}}();